<!-- <p>add-lead-list works!</p> -->
<!-- Header -->
<app-db-header></app-db-header>
<!-- Header ends -->

<div class="wrapper_shala wrapper_db">
	<section class="outer_db_wraper db_main_invstr">
		<div class="combine_sidenav_right_db d-flex">
			<div class="main_right_db invstr_db">
				<section class="bread_top_sec">
					<div class="db_container">
						<div class="d-flex justify-content-between align-items-center text-white pos_rel">
							<div class="sid_controlr">
								<i class="clos_sid fa fa-bars"></i>
								<!-- <i class="opn_sid fa fa-times"></i> -->
							</div>
							<h3>Add Lead</h3>
							<!-- <nav class="bread_nav_sec">
								<ol class="breadcrumb">
								    <li class="breadcrumb-item"><a href="#">Home</a></li>
								    <li class="breadcrumb-item">Dashboard</li>
								    <li class="breadcrumb-item active">Add Lead List</li>
								</ol>
							</nav> -->
						</div>
					</div>
				</section>
				<div class="marg_over_bread">
					<section class="review_sec_db">
						<div class="db_container">
							<div class="row">
								<div class="col-sm-12">
									<div class="card">
										<div class="card-body">
											<!-- <div class="card_ttl">
												<h3>Add Lead List</h3>
												<small class="sub_crd">A project is an activity to meet the creation of
													a unique product or service and thus activities that are undertaken
													to accomplish routine activities.</small>
											</div> -->
											<div class="add_lead_lst">
												<form [formGroup]="form">
													<div class="row">
														<div class="col-sm-4">
															<div class="form-group">
																<label>Surname</label>
																<div class="pos_rel">
																	<input type="text" formControlName="LastName"
																		class="form-control" placeholder=""
																		maxlength="22">

																	<span
																		*ngIf="LastName.invalid && (LastName.dirty || LastName.touched || saveButton)"
																		class="text-danger">
																		<span *ngIf="LastName.errors.required">
																			This field is required.
																		</span>
																		<span *ngIf="LastName.errors.pattern">
																			Invalid Surname
																		</span>
																	</span>
																</div>
															</div>
														</div>
														<div class="col-sm-4">
															<div class="form-group">
																<label>First Name</label>
																<div class="pos_rel">
																	<input formControlName="FirstName" type="text"
																		class="form-control" placeholder=""
																		maxlength="22">

																	<span
																		*ngIf="FirstName.invalid && (FirstName.dirty || FirstName.touched || saveButton)"
																		class="text-danger">
																		<span *ngIf="FirstName.errors.required">
																			This field is required.
																		</span>
																		<span *ngIf="FirstName.errors.pattern">
																			Invalid Firstname
																		</span>
																	</span>
																</div>
															</div>
														</div>
														<div class="col-sm-4">
															<div class="form-group">
																<label>ID</label>
																<div class="pos_rel">
																	<input formControlName="IdNumber" type="text"
																		class="form-control" placeholder=""
																		maxlength="15">

																	<span
																		*ngIf="IdNumber.invalid && (IdNumber.dirty || IdNumber.touched || saveButton)"
																		class="text-danger">
																		<!-- <span *ngIf="IdNumber.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="IdNumber.errors.pattern">
																			Invalid Pattern
																		</span>
																	</span>
																</div>
															</div>
														</div>
													</div>
													<div class="row">
														<div class="col-sm-4">
															<div class="form-group">
																<label>Cell No.</label>
																<div class="pos_rel">
																	<input formControlName="CellNumber" type="text"
																		class="form-control" placeholder=""
																		maxlength="15">

																	<span
																		*ngIf="CellNumber.invalid && (CellNumber.dirty || CellNumber.touched|| saveButton )"
																		class="text-danger">
																		<!-- <span *ngIf="CellNumber.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="CellNumber.errors.pattern">
																			Invalid Cell No.
																		</span>
																	</span>
																</div>
															</div>
														</div>
														<div class="col-sm-4">
															<div class="form-group">
																<label>Other Contact No.</label>
																<div class="pos_rel">
																	<input formControlName="HomeNumber" type="text"
																		class="form-control" placeholder=""
																		maxlength="15">

																	<span
																		*ngIf="HomeNumber.invalid && (HomeNumber.dirty || HomeNumber.touched|| saveButton )"
																		class="text-danger">
																		<!-- <span *ngIf="HomeNumber.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="HomeNumber.errors.pattern">
																			Invalid Contact No.
																		</span>
																	</span>
																</div>
															</div>
														</div>
														<div class="col-sm-4">
															<div class="form-group">
																<label>Email</label>
																<div class="pos_rel">
																	<input formControlName="Email" type="text"
																		class="form-control" placeholder="">

																	<span
																		*ngIf="Email.invalid && (Email.dirty || Email.touched || saveButton)"
																		class="text-danger">
																		<!-- <span *ngIf="Email.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="Email.errors.pattern">
																			Please enter a valid email
																		</span>
																	</span>
																</div>
															</div>
														</div>
													</div>
													
													<div class="row">
														<div class="col-sm-12">
															<div class="form-group">
																<label>Address</label>
																<div class="pos_rel">
																	<input formControlName="HomeAddress" type="text"
																		class="form-control" placeholder=""
																		ngxAutocomPlace
																		(selectedPlace)="placeChangedCallback($event)">
																	<dir></dir>

																	<span
																		*ngIf="HomeAddress.invalid && (HomeAddress.dirty || HomeAddress.touched || saveButton)"
																		class="text-danger">
																		<!-- <span *ngIf="HomeAddress.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="HomeAddress.errors.pattern">
																			Invalid Address
																		</span>
																	</span>
																</div>
															</div>
														</div>
													</div>
													<div class="row">
														<div class="col-sm-12">
															<div class="form-group">
																<label>Note</label>
																<div class="pos_rel">
																	<textarea formControlName="Note" type="text"
																		class="form-control" placeholder=""></textarea>

																	<span
																		*ngIf="Note.invalid && (Note.dirty || Note.touched || saveButton)"
																		class="text-danger">
																		<!-- <span *ngIf="Note.errors.required">
																			This field is required.
																		</span> -->
																		<span *ngIf="Note.errors.pattern">
																			Invalid Note
																		</span>
																	</span>
																</div>
															</div>
														</div>
													</div>
													<div class="row">
														<div class="col-sm-12">
															<div class="form-group">
																<label>Follow Up Date</label>
																<div class="pos_rel">
																	<mat-form-field appearance="fill">
																		<input matInput [matDatepicker]="pickerFrom" 
																			[(ngModel)]="follow_up_date"
																			[ngModelOptions]="{standalone: true}">
																		<mat-datepicker-toggle matSuffix
																			[for]="pickerFrom">
																		</mat-datepicker-toggle>
																		<mat-datepicker #pickerFrom></mat-datepicker>
																	</mat-form-field>
																	<!-- <span *ngIf="!follow_up_date && saveButton"
																		class="text-danger">
																		This field is required.
																	</span> -->
																</div>
															</div>
														</div>
													</div>

													<div class="row">
														<div class="col-sm-12">
															<div class="form-group">
																<label>Status</label>
																<div class="pos_rel">
																	<select formControlName="status"
																		class="custom-select form-control">
																		<option value="call_lead">Call Lead</option>
																		<option value="client">Become Client</option>
																		<option value="upcoming">Upcoming</option>
																	</select>
																</div>
															</div>
														</div>
													</div>
													<div class="form-group text-right">
														<div class="pos_rel log_sgn_btn">
															<a (click)="addLead()" href="javascript:;"
																class="btn btn_theme sgnup_btn"> Save List </a>
														</div>
													</div>
												</form>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
				</div>
			</div>
			<div class="modal" id="myModal">
				<div class="modal-dialog">
					<div class="modal-content">

						<!-- Modal Header -->
						<div class="modal-header">
							<h4 class="modal-title">Modal Heading</h4>
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>

						<!-- Modal body -->
						<div class="modal-body">
							Modal body..
						</div>

						<!-- Modal footer -->
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
						</div>

					</div>
				</div>
			</div>
			<div class="sidenav_db">
				<app-db-sidebar></app-db-sidebar>
			</div>
		</div>
	</section>
	<!-- footer starts -->
	<!-- <app-footer></app-footer> -->
	<!-- footer ends -->
</div>
<!-- <script>
    
    var latitude = '28.7041' ;
    var longitude = '77.1025' ;
    function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat:latitude, lng:longitude },
          zoom: 10,
        });

        var input = document.getElementById('address');
        
        var autocomplete = new google.maps.places.Autocomplete(input);

        var componentForm = {
          // street_number: 'short_name',
          // route: 'long_name',
          // locality: 'long_name',
          administrative_area_level_2: 'long_name',
          administrative_area_level_1: 'long_name',
          // country: 'long_name',
          // postal_code: 'short_name'
        };
        
        // Set the data fields to return when the user selects a place.
        // autocomplete.setFields(['address_components', 'geometry', 'icon', 'name']);
        autocomplete.setFields(['address_components','geometry','icon', 'name']);

        var infowindow = new google.maps.InfoWindow();
        var infowindowContent = document.getElementById('infowindow-content');
        infowindow.setContent(infowindowContent);

        var pos = {
            lat: latitude,
            lng: longitude
        };
        var marker = new google.maps.Marker({
            position: pos,
            map: map
        });

        /*var marker = new google.maps.Marker({
          map: map,
          anchorPoint: new google.maps.Point(0, -29)
        });*/


        autocomplete.addListener('place_changed', function() {
            infowindow.close();
            marker.setVisible(false);
            var place = autocomplete.getPlace();

            for (var component in componentForm) {
                document.getElementById(component).value = '';
                document.getElementById(component).disabled = false;
            }

            for (var i = 0; i < place.address_components.length; i++) {
                var addressType = place.address_components[i].types[0];
                if (componentForm[addressType]) {
                    var val = place.address_components[i][componentForm[addressType]];
                    document.getElementById(addressType).value = val;
                }   
            }

            var latitude = place.geometry.location.lat();
            var longitude = place.geometry.location.lng();

            $('#latitude').val(latitude);
            $('#longitude').val(longitude);
            // console.log(place);

            if (!place.geometry) {
                // User entered the name of a Place that was not suggested and
                // pressed the Enter key, or the Place Details request failed.
                window.alert("No details available for input: '" + place.name + "'");
                return;
            }
            
            // If the place has a geometry, then present it on a map.
            if (place.geometry.viewport) {
                map.fitBounds(place.geometry.viewport);
            } else {
                map.setCenter(place.geometry.location);
                map.setZoom(17);  // Why 17? Because it looks good.
            }
            marker.setPosition(place.geometry.location);
            marker.setVisible(true);

            var address = '';
            if (place.address_components) {
                address = [
                  (place.address_components[0] && place.address_components[0].short_name || ''),
                  // (place.address_components[1] && place.address_components[1].short_name || ''),
                  (place.address_components[2] && place.address_components[2].short_name || ''),
                  (place.address_components[3] && place.address_components[3].short_name || ''),
                  (place.address_components[5] && place.address_components[5].short_name || ''),
                ].join(' ');
            }

            infowindowContent.children['place-icon'].src = place.icon;
            infowindowContent.children['place-name'].textContent = place.name;
            infowindowContent.children['place-address'].textContent = address;
            infowindow.open(map, marker);
        });

        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
    }

    function reInitMap(latitude,longitude) {
        var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat:latitude, lng:longitude },
          zoom: 17,
        });

        var input = document.getElementById('address');
        
        var autocomplete = new google.maps.places.Autocomplete(input);

        var componentForm = {
            // street_number: 'short_name',
            // route: 'long_name',
            // locality: 'long_name',
            administrative_area_level_2: 'long_name',
            administrative_area_level_1: 'long_name',
            // country: 'long_name',
            // postal_code: 'short_name'
        };
        
        // Set the data fields to return when the user selects a place.
        // autocomplete.setFields(['address_components', 'geometry', 'icon', 'name']);
        autocomplete.setFields(['address_components','geometry','icon', 'name']);

        var infowindow = new google.maps.InfoWindow();
        var infowindowContent = document.getElementById('infowindow-content');
        infowindow.setContent(infowindowContent);
        /*var marker = new google.maps.Marker({
          map: map,
          anchorPoint: new google.maps.Point(0, -29)
        });*/
         var pos = {
            lat: latitude,
            lng: longitude
        };
        var marker = new google.maps.Marker({
            position: pos,
            map: map
        });


        autocomplete.addListener('place_changed', function() {
            infowindow.close();
            marker.setVisible(false);
            var place = autocomplete.getPlace();

            for (var component in componentForm) {
                document.getElementById(component).value = '';
                document.getElementById(component).disabled = false;
            }

            for (var i = 0; i < place.address_components.length; i++) {
                var addressType = place.address_components[i].types[0];
                if (componentForm[addressType]) {
                    var val = place.address_components[i][componentForm[addressType]];
                    document.getElementById(addressType).value = val;
                }   
            }

            var latitude = place.geometry.location.lat();
            var longitude = place.geometry.location.lng();

            $('#latitude').val(latitude);
            $('#longitude').val(longitude);
            // console.log(place);

            if (!place.geometry) {
                // User entered the name of a Place that was not suggested and
                // pressed the Enter key, or the Place Details request failed.
                window.alert("No details available for input: '" + place.name + "'");
                return;
            }
            
            // If the place has a geometry, then present it on a map.
            if (place.geometry.viewport) {
                map.fitBounds(place.geometry.viewport);
            } else {
                map.setCenter(place.geometry.location);
                map.setZoom(17);  // Why 17? Because it looks good.
            }
            marker.setPosition(place.geometry.location);
            marker.setVisible(true);

            var address = '';
            if (place.address_components) {
                address = [
                  (place.address_components[0] && place.address_components[0].short_name || ''),
                  // (place.address_components[1] && place.address_components[1].short_name || ''),
                  (place.address_components[2] && place.address_components[2].short_name || ''),
                  (place.address_components[3] && place.address_components[3].short_name || ''),
                  (place.address_components[5] && place.address_components[5].short_name || ''),
                ].join(' ');
            }

            infowindowContent.children['place-icon'].src = place.icon;
            infowindowContent.children['place-name'].textContent = place.name;
            infowindowContent.children['place-address'].textContent = address;
            infowindow.open(map, marker);
        });

        marker.addListener('click', function() {
          infowindow.open(map, marker);
        });
    }
</script> -->
<!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQhN-xkQiUIQ9toO-KRdb9wqtc_cGbAqo&libraries=places&callback=initMap"></script> -->